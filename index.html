<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>Welcome to India Shatabdi News</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">India Shatabdi News</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="card">
        <div class="card-body text-center">
            <p class="card-text">Your break will end in :</p>
            <h5 class="card-title">&#9201</h5>
          <a href="#" id="countDown" class="btn btn-primary countDown"></a>
        </div>  
      </div>
    
    <p class="countDown" id="countDown">

    </p>
    <div class="container my-3">
        <h1>Top News<span class="badge bg-secondary">by Indian Shatabdi News</span></h1>
        <hr>
        <div class="accordion" id="newsAccordion">
            
        </div>
        
        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script> -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
            integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
            crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
</body>
    <script>
//         https://dummyapi.io/data/v1/user?limit=10

        let source = 'bbc-news';
        let apiKey = 'f99a4e7d83aa4ccca60b6bc328283a00';
        let newsAccordion = document.getElementById("newsAccordion");
        let newsHTML = "";

        // For timer
        var now = new Date();
        var timer = new Date(); 
        timer.setHours(0);
        timer.setMinutes(0);
        timer.setSeconds(1000);
        let storeTime = new Date();
        let hours;
        let minutes;
        let seconds;

        // For search news
        let title = new Array();
        let i = 0;
        let time = setInterval(() => {
            timer.setSeconds(timer.getSeconds() - 1);
            // console.log(timer); 
            storeTime = `${timer.getHours()} : ${timer.getMinutes()} : ${timer.getSeconds()}`;
            if(timer.getHours() <= 9){
                hours = "0"+timer.getHours();
            }
            else{
                hours = timer.getHours();
            }
            if(timer.getMinutes() <= 9){
                minutes = "0"+timer.getMinutes();
            }
            else{
                minutes = timer.getMinutes();
            }
            if(timer.getSeconds() <= 9){
                seconds = "0"+timer.getSeconds();
            }
            else{
                seconds = timer.getSeconds();
            }
            countDown.innerHTML = `${hours} : ${minutes} : ${seconds}`
            setTimeout(() => {
                if(hours==0 && minutes==0 && seconds==0){
                    // let value = confirm("Your break is over");
                    if(confirm("Your break is over")){
                        window.close();
                    }
                    else{
                        location.reload();
                    }
                    // if(value=="reset time"){
                        // window.on.reload();
                    // }
                    // alert("Your break is over.");
                }
            }, 1000);
        }, 1000);

        let countDown = document.getElementById("countDown");

        function getData() {
            url = `https://newsapi.org/v2/top-headlines?sources=${source}&apiKey=${apiKey}`;
            console.log("Started getData")
            fetch(url).then((response)=>{
                console.log("Inside first then");
                return response.json();
            }).then((data)=>{
                console.log("Inside second then");
                let articles = data.articles;
                articles.forEach(function(element, index) {
                    // console.log(element,index)
                    title[i] = element.title;
                    // console.log(title[i]);
                    let news = `
                                <div class="accordion-item noteCards">
                                    <h2 class="accordion-header" id="heading${index}">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse${index}" aria-expanded="true" aria-controls="collapse${index}">
                                    <b>Breaking News ${index+1}: </b> ${element["title"]}
                                    </button>
                                    </h2>
                                    <div id="collapse${index}" class="accordion-collapse collapse" aria-labelledby="heading${index}" data-bs-parent="#newsAccordion">
                                    <div class="accordion-body">
                                    ${element["content"]}
                                    <a href="${element["url"]}" target="_blank">Read more here</a>
                                    </div>
                                    </div>
                                </div>`
                                newsHTML += news
                })
                newsAccordion.innerHTML = newsHTML;
                // console.log(data.articles)
                // console.log(articles)
            })
        }

        getData()
    </script>    

</html>
